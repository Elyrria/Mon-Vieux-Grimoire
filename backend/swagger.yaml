openapi: 3.0.0
info:
    description: |
        API du site Mon Vieux Grimoire. Ici on retrouvera les diffÃ©rentes routes pour la rÃ©cupÃ©ration/modification/suppression d'un livre. Mais aussi pour l'authentification.
    version: "1.0.0"
    title: Mon Vieux Grimoire API
    contact:
        email: quentindumon352a@gmail.com
    license:
        name: Apache 2.0
        url: "http://www.apache.org/licenses/LICENSE-2.0.html"
servers:
    # Added by API Auto Mocking Plugin
    - description: SwaggerHub API Auto Mocking
      url: https://virtserver.swaggerhub.com/QUENTINDUMON352A/MonVieuxGrimoire/1.0.0
    - url: "http://localhost:4000"
tags:
    - name: books
      description: Tous Ã -propos des livres
    - name: user
      description: OpÃ©ration Ã -propos des utilisateurs
paths:
    /api/books:
        post:
            tags:
                - books
            summary: Ajout d'un nouveau livre ğŸ‘Œ
            description: Permet de rajouter un livre dans la base de donnÃ©es avec les Ã©lÃ©ments fourni dans le body de la requÃªte ğŸ“–
            operationId: addBook
            parameters:
                - name: token
                  in: header
                  required: true
                  schema:
                      type: string
            responses:
                "201":
                    description: Livre crÃ©Ã©e âœ…
                "400":
                    description: RequÃªte invalide â›”ï¸
                "401":
                    description: Droits refusÃ©s ğŸ›‘ï¸
                "404":
                    description: Livre non trouvÃ© ğŸ¤·â€â™‚
            security:
                - bearerAuth: []
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                book:
                                    type: string
                                image:
                                    type: string
        get:
            tags:
                - books
            summary: RÃ©cupÃ¨ration de tous les livres ğŸ“š
            description: RÃ©cupÃ©ration de tous les livres depuis la base de donnÃ©es ğŸ›œ
            operationId: findBooks
            responses:
                "200":
                    description: OpÃ©ration rÃ©ussite âœ…
                    content:
                        application/json:
                            schema:
                                type: array
                                items:
                                    type: object
                                    properties:
                                        userId:
                                            type: string
                                        title:
                                            type: string
                                        author:
                                            type: string
                                        imageUrl:
                                            type: string
                                        year:
                                            type: integer
                                        genre:
                                            type: string
                                        ratings:
                                            type: array
                                            items:
                                                type: object
                                                properties:
                                                    userId:
                                                        type: string
                                                    grade:
                                                        type: number
                                        averageRating:
                                            type: number
                "400":
                    description: RequÃªte invalide âŒ
    /api/books/:id:
        get:
            tags:
                - books
            summary: RÃ©cupÃ¨ration d'un livre avec son id spÃ©cifiÃ© dans les paramÃ¨tres de la requÃªte
            operationId: findOneBooks
            responses:
                "200":
                    description: OpÃ©ration rÃ©ussite âœ…
                    content:
                        application/json:
                            schema:
                                type: object
                                properties:
                                    userId:
                                        type: string
                                    title:
                                        type: string
                                    author:
                                        type: string
                                    imageUrl:
                                        type: string
                                    year:
                                        type: integer
                                    genre:
                                        type: string
                                    ratings:
                                        type: array
                                        items:
                                            type: object
                                            properties:
                                                userId:
                                                    type: string
                                                grade:
                                                    type: number
                                    averageRating:
                                        type: number

                "400":
                    description: RequÃªte invalide âŒ
        put:
            tags:
                - books
            summary: Mise Ã  jour d'un livre existant â™»ï¸
            description: Permet de mettre Ã  jour le livre spÃ©cifiÃ© dans les paramÃ¨tres âš™ï¸âš™ï¸âš™ï¸ de la requÃ¨te ğŸ‘Œ
            operationId: updateBook
            parameters:
                - name: token
                  in: header
                  required: true
                  schema:
                      type: string
            responses:
                "200":
                    description: RÃ©quÃªte rÃ©ussie âœ…
                "400":
                    description: RequÃªte invalide â›”ï¸
                "401":
                    description: Droits refusÃ©s ğŸ›‘ï¸
                "404":
                    description: Livre non trouvÃ© ğŸ¤·â€â™‚
            security:
                - bearerAuth: []
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                book:
                                    type: string
                                image:
                                    type: string
        delete:
            tags:
                - books
            summary: Suppression d'un livre ğŸ›‘
            description: Permet de supprimer un livre avec l'id passÃ© en paramÃ¨tres âš™ï¸âš™ï¸âš™ï¸ de la requÃªte âŒ
            operationId: deleteBook
            parameters:
                - name: token
                  in: header
                  required: true
                  schema:
                      type: string
            responses:
                "200":
                    description: RÃ©quÃªte rÃ©ussie âœ…
                "400":
                    description: RequÃªte invalide â›”ï¸
                "401":
                    description: Droits refusÃ©s ğŸ›‘ï¸
                "404":
                    description: Livre non trouvÃ© ğŸ¤·â€â™‚
            security:
                - bearerAuth: []
    /api/books/:id/rating:
        post:
            tags:
                - books
            summary: Atribue une note au livre ğŸ“•
            description: Permet d'attribuer une note au livre passÃ© en id dans les paramÃ¨tres âš™ï¸âš™ï¸âš™ï¸ de la requÃªte ğŸ’¯
            operationId: ratingBook
            parameters:
                - name: token
                  in: header
                  required: true
                  schema:
                      type: string
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                userId:
                                    type: string
                                rating:
                                    type: number
            responses:
                "201":
                    description: Note crÃ©Ã©e âœ…
                    content:
                        application/json:
                            schema:
                                type: object
                                properties:
                                    userId:
                                        type: string
                                    title:
                                        type: string
                                    author:
                                        type: string
                                    imageUrl:
                                        type: string
                                    year:
                                        type: integer
                                    genre:
                                        type: string
                                    ratings:
                                        type: array
                                        items:
                                            type: object
                                            properties:
                                                userId:
                                                    type: string
                                                grade:
                                                    type: number
                                    averageRating:
                                        type: number
                "400":
                    description: RequÃªte invalide â›”ï¸
                "401":
                    description: Droits refusÃ©s ğŸ›‘ï¸
                "404":
                    description: Livre non trouvÃ© ğŸ¤·â€â™‚
            security:
                - bearerAuth: []
    /api/books/bestrating:
        get:
            tags:
                - books
            summary: RÃ©cupÃ©ration des trois livres les mieux notÃ©s ğŸ“—
            description: Permet de rÃ©cupÃ©rer les trois livres ayant la meilleur moyenne ğŸ’¯
            operationId: bestRatingBook
            responses:
                "200":
                    description: RÃ©quÃªte rÃ©ussie âœ…
                    content:
                        application/json:
                            schema:
                                type: array
                                items:
                                    type: object
                                    properties:
                                        userId:
                                            type: string
                                        title:
                                            type: string
                                        author:
                                            type: string
                                        imageUrl:
                                            type: string
                                        year:
                                            type: integer
                                        genre:
                                            type: string
                                        ratings:
                                            type: array
                                            items:
                                                type: object
                                                properties:
                                                    userId:
                                                        type: string
                                                    grade:
                                                        type: number
                                        averageRating:
                                            type: number
                "400":
                    description: RequÃªte invalide â›”ï¸

    /api/auth/signup:
        post:
            tags:
                - user
            summary: CrÃ©ation d'utilisateur ğŸ‘¨â€ğŸ’»
            description: Route permettant d'enregistrer un utilisateur dans la base de donnÃ©es avec l'email et le password dans les paramÃ¨tres âš™ï¸âš™ï¸âš™ï¸ de la requÃªte ğŸ›£ ï¸
            operationId: createUser
            responses:
                "201":
                    description: Utilisateur crÃ©Ã© âœ…
                "400":
                    description: RequÃªte invalide â›”ï¸
                "500":
                    description: Erreur serveur â›”ï¸
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                email:
                                    type: string
                                password:
                                    type: string
    /api/auth/login:
        post:
            tags:
                - user
            summary: Connexion utilisateur ğŸ‘¨â€ğŸ’»
            description: Permet de se connecter et de rÃ©cupÃ©rer le token de connexion dans la rÃ©ponse ğŸ‘Œ
            operationId: loginUser
            responses:
                "200":
                    description: OpÃ©ration rÃ©ussite âœ…
                    content:
                        application/json:
                            schema:
                                type: object
                                properties:
                                    userId:
                                        type: string
                                    token:
                                        type: string
                "401":
                    description: Paire identifiant/mot de passe inccorrecte ğŸ›‘
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                email:
                                    type: string
                                password:
                                    type: string

components:
    securitySchemes:
        bearerAuth:
            type: http
            scheme: bearer
